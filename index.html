<!DOCTYPE html>
<html>

<head>
    <meta charset="utf-8" />
    <title>Binance Futures Calculator</title>
    <link rel="stylesheet" href="styles.css">
</head>

<body>
    <table class="trello-table">
        <thead>
            <tr>
                <th>Coin Name</th>
                <th style="background-color: rgb(21, 151, 64);">Entry Price</th>
                <th>Leverage</th>
                <th style="background-color: rgb(21, 151, 64);">Account Size</th>
                <th>Target Profit (USDT)</th>
                <th style="background-color: rgb(21, 151, 64);">Position Size</th>
                <th>Quantity</th>
                <th style="color: rgb(255, 255, 255); font-weight: bold; background-color: rgb(10, 145, 122);">Tg Long
                    Price</th>
                <th style="color: rgb(236, 234, 109); font-weight: bold; background-color: rgb(161, 23, 23);">(L)
                    Liquidation Price</th>
                <th style="background-color: rgb(161, 23, 161);">Tg Short Price</th>
                <th style="color: rgb(236, 234, 109); font-weight: bold; background-color: rgb(161, 23, 23)">(S)
                    Liquidation Price</th>
            </tr>
        </thead>
        <tbody id="calculatorRows">
            <!-- Row 1 -->
            <tr class="calculator-row" data-row="1" data-symbol="BTCUSDT">
                <td class="coin-name">BTCUSDT</td>
                <td class="price-cell">-</td>
                <td>
                    <select class="leverage-select">
                        <option value="10">10</option>
                        <option value="15">15</option>
                        <option value="20">20</option>
                        <option value="25">25</option>
                        <option value="30">30</option>
                        <option value="35">35</option>
                        <option value="40">40</option>
                        <option value="45">45</option>
                        <option value="50">50</option>
                    </select>
                </td>
                <td>
                    <select class="account-size-select">
                        <option value="100">100</option>
                        <option value="125">125</option>
                        <option value="150">150</option>
                        <option value="175">175</option>
                        <option value="200">200</option>
                        <option value="225">225</option>
                        <option value="250">250</option>
                        <option value="275">275</option>
                        <option value="300">300</option>
                        <option value="325">325</option>
                        <option value="350">350</option>
                        <option value="375">375</option>
                        <option value="400">400</option>
                        <option value="425">425</option>
                        <option value="450">450</option>
                        <option value="475">475</option>
                        <option value="500">500</option>
                    </select>
                </td>
                <td>
                    <select class="target-profit-select">
                        <option value="10">10</option>
                        <option value="15">15</option>
                        <option value="20">20</option>
                        <option value="25">25</option>
                        <option value="30">30</option>
                        <option value="35">35</option>
                        <option value="40">40</option>
                        <option value="45">45</option>
                        <option value="50">50</option>
                        <option value="50">60</option>
                        <option value="50">70</option>
                        <option value="50">80</option>
                        <option value="50">90</option>
                        <option value="50">100</option>
                        <option value="50">150</option>
                        <option value="50">200</option>
                        <option value="50">300</option>
                        <option value="50">500</option>
                    </select>
                </td>
                <td class="position-size-cell">-</td>
                <td class="quantity-cell">-</td>
                <td class="tg-long-cell">-</td>
                <td class="liq-long-cell">-</td>
                <td class="tg-short-cell">-</td>
                <td class="liq-short-cell">-</td>
            </tr>

            <!-- Row 2 -->
            <tr class="calculator-row" data-row="2" data-symbol="ETHUSDT">
                <td class="coin-name">ETHUSDT</td>
                <td class="price-cell">-</td>
                <td>
                    <select class="leverage-select">
                        <option value="10">10</option>
                        <option value="15">15</option>
                        <option value="20">20</option>
                        <option value="25">25</option>
                        <option value="30">30</option>
                        <option value="35">35</option>
                        <option value="40">40</option>
                        <option value="45">45</option>
                        <option value="50">50</option>
                    </select>
                </td>
                <td>
                    <select class="account-size-select">
                        <option value="100">100</option>
                        <option value="125">125</option>
                        <option value="150">150</option>
                        <option value="175">175</option>
                        <option value="200">200</option>
                        <option value="225">225</option>
                        <option value="250">250</option>
                        <option value="275">275</option>
                        <option value="300">300</option>
                        <option value="325">325</option>
                        <option value="350">350</option>
                        <option value="375">375</option>
                        <option value="400">400</option>
                        <option value="425">425</option>
                        <option value="450">450</option>
                        <option value="475">475</option>
                        <option value="500">500</option>
                    </select>
                </td>
                <td>
                    <select class="target-profit-select">
                        <option value="10">10</option>
                        <option value="15">15</option>
                        <option value="20">20</option>
                        <option value="25">25</option>
                        <option value="30">30</option>
                        <option value="35">35</option>
                        <option value="40">40</option>
                        <option value="45">45</option>
                        <option value="50">50</option>
                        <option value="50">60</option>
                        <option value="50">70</option>
                        <option value="50">80</option>
                        <option value="50">90</option>
                        <option value="50">100</option>
                        <option value="50">150</option>
                        <option value="50">200</option>
                        <option value="50">300</option>
                        <option value="50">500</option>
                    </select>
                </td>
                <td class="position-size-cell">-</td>
                <td class="quantity-cell">-</td>
                <td class="tg-long-cell">-</td>
                <td class="liq-long-cell">-</td>
                <td class="tg-short-cell">-</td>
                <td class="liq-short-cell">-</td>
            </tr>

            <!-- Row 3 -->
            <tr class="calculator-row" data-row="3" data-symbol="BNBUSDT">
                <td class="coin-name">BNBUSDT</td>
                <td class="price-cell">-</td>
                <td>
                    <select class="leverage-select">
                        <option value="10">10</option>
                        <option value="15">15</option>
                        <option value="20">20</option>
                        <option value="25">25</option>
                        <option value="30">30</option>
                        <option value="35">35</option>
                        <option value="40">40</option>
                        <option value="45">45</option>
                        <option value="50">50</option>
                    </select>
                </td>
                <td>
                    <select class="account-size-select">
                        <option value="100">100</option>
                        <option value="125">125</option>
                        <option value="150">150</option>
                        <option value="175">175</option>
                        <option value="200">200</option>
                        <option value="225">225</option>
                        <option value="250">250</option>
                        <option value="275">275</option>
                        <option value="300">300</option>
                        <option value="325">325</option>
                        <option value="350">350</option>
                        <option value="375">375</option>
                        <option value="400">400</option>
                        <option value="425">425</option>
                        <option value="450">450</option>
                        <option value="475">475</option>
                        <option value="500">500</option>
                    </select>
                </td>
                <td>
                    <select class="target-profit-select">
                        <option value="10">10</option>
                        <option value="15">15</option>
                        <option value="20">20</option>
                        <option value="25">25</option>
                        <option value="30">30</option>
                        <option value="35">35</option>
                        <option value="40">40</option>
                        <option value="45">45</option>
                        <option value="50">50</option>
                        <option value="50">60</option>
                        <option value="50">70</option>
                        <option value="50">80</option>
                        <option value="50">90</option>
                        <option value="50">100</option>
                        <option value="50">150</option>
                        <option value="50">200</option>
                        <option value="50">300</option>
                        <option value="50">500</option>
                    </select>
                </td>
                <td class="position-size-cell">-</td>
                <td class="quantity-cell">-</td>
                <td class="tg-long-cell">-</td>
                <td class="liq-long-cell">-</td>
                <td class="tg-short-cell">-</td>
                <td class="liq-short-cell">-</td>
            </tr>

            <!-- Row 4 -->
            <tr class="calculator-row" data-row="4" data-symbol="SOLUSDT">
                <td class="coin-name">SOLUSDT</td>
                <td class="price-cell">-</td>
                <td>
                    <select class="leverage-select">
                        <option value="10">10</option>
                        <option value="15">15</option>
                        <option value="20">20</option>
                        <option value="25">25</option>
                        <option value="30">30</option>
                        <option value="35">35</option>
                        <option value="40">40</option>
                        <option value="45">45</option>
                        <option value="50">50</option>
                    </select>
                </td>
                <td>
                    <select class="account-size-select">
                        <option value="100">100</option>
                        <option value="125">125</option>
                        <option value="150">150</option>
                        <option value="175">175</option>
                        <option value="200">200</option>
                        <option value="225">225</option>
                        <option value="250">250</option>
                        <option value="275">275</option>
                        <option value="300">300</option>
                        <option value="325">325</option>
                        <option value="350">350</option>
                        <option value="375">375</option>
                        <option value="400">400</option>
                        <option value="425">425</option>
                        <option value="450">450</option>
                        <option value="475">475</option>
                        <option value="500">500</option>
                    </select>
                </td>
                <td>
                    <select class="target-profit-select">
                        <option value="10">10</option>
                        <option value="15">15</option>
                        <option value="20">20</option>
                        <option value="25">25</option>
                        <option value="30">30</option>
                        <option value="35">35</option>
                        <option value="40">40</option>
                        <option value="45">45</option>
                        <option value="50">50</option>
                        <option value="50">60</option>
                        <option value="50">70</option>
                        <option value="50">80</option>
                        <option value="50">90</option>
                        <option value="50">100</option>
                        <option value="50">150</option>
                        <option value="50">200</option>
                        <option value="50">300</option>
                        <option value="50">500</option>
                    </select>
                </td>
                <td class="position-size-cell">-</td>
                <td class="quantity-cell">-</td>
                <td class="tg-long-cell">-</td>
                <td class="liq-long-cell">-</td>
                <td class="tg-short-cell">-</td>
                <td class="liq-short-cell">-</td>
            </tr>

            <!-- Row 5 -->
            <tr class="calculator-row" data-row="5" data-symbol="ADAUSDT">
                <td class="coin-name">ADAUSDT</td>
                <td class="price-cell">-</td>
                <td>
                    <select class="leverage-select">
                        <option value="10">10</option>
                        <option value="15">15</option>
                        <option value="20">20</option>
                        <option value="25">25</option>
                        <option value="30">30</option>
                        <option value="35">35</option>
                        <option value="40">40</option>
                        <option value="45">45</option>
                        <option value="50">50</option>
                    </select>
                </td>
                <td>
                    <select class="account-size-select">
                        <option value="100">100</option>
                        <option value="125">125</option>
                        <option value="150">150</option>
                        <option value="175">175</option>
                        <option value="200">200</option>
                        <option value="225">225</option>
                        <option value="250">250</option>
                        <option value="275">275</option>
                        <option value="300">300</option>
                        <option value="325">325</option>
                        <option value="350">350</option>
                        <option value="375">375</option>
                        <option value="400">400</option>
                        <option value="425">425</option>
                        <option value="450">450</option>
                        <option value="475">475</option>
                        <option value="500">500</option>
                    </select>
                </td>
                <td>
                    <select class="target-profit-select">
                        <option value="10">10</option>
                        <option value="15">15</option>
                        <option value="20">20</option>
                        <option value="25">25</option>
                        <option value="30">30</option>
                        <option value="35">35</option>
                        <option value="40">40</option>
                        <option value="45">45</option>
                        <option value="50">50</option>
                        <option value="50">60</option>
                        <option value="50">70</option>
                        <option value="50">80</option>
                        <option value="50">90</option>
                        <option value="50">100</option>
                        <option value="50">150</option>
                        <option value="50">200</option>
                        <option value="50">300</option>
                        <option value="50">500</option>
                    </select>
                </td>
                <td class="position-size-cell">-</td>
                <td class="quantity-cell">-</td>
                <td class="tg-long-cell">-</td>
                <td class="liq-long-cell">-</td>
                <td class="tg-short-cell">-</td>
                <td class="liq-short-cell">-</td>
            </tr>

            <!-- Row 6 -->
            <tr class="calculator-row" data-row="6" data-symbol="XRPUSDT">
                <td class="coin-name">XRPUSDT</td>
                <td class="price-cell">-</td>
                <td>
                    <select class="leverage-select">
                        <option value="10">10</option>
                        <option value="15">15</option>
                        <option value="20">20</option>
                        <option value="25">25</option>
                        <option value="30">30</option>
                        <option value="35">35</option>
                        <option value="40">40</option>
                        <option value="45">45</option>
                        <option value="50">50</option>
                    </select>
                </td>
                <td>
                    <select class="account-size-select">
                        <option value="100">100</option>
                        <option value="125">125</option>
                        <option value="150">150</option>
                        <option value="175">175</option>
                        <option value="200">200</option>
                        <option value="225">225</option>
                        <option value="250">250</option>
                        <option value="275">275</option>
                        <option value="300">300</option>
                        <option value="325">325</option>
                        <option value="350">350</option>
                        <option value="375">375</option>
                        <option value="400">400</option>
                        <option value="425">425</option>
                        <option value="450">450</option>
                        <option value="475">475</option>
                        <option value="500">500</option>
                    </select>
                </td>
                <td>
                    <select class="target-profit-select">
                        <option value="10">10</option>
                        <option value="15">15</option>
                        <option value="20">20</option>
                        <option value="25">25</option>
                        <option value="30">30</option>
                        <option value="35">35</option>
                        <option value="40">40</option>
                        <option value="45">45</option>
                        <option value="50">50</option>
                        <option value="50">60</option>
                        <option value="50">70</option>
                        <option value="50">80</option>
                        <option value="50">90</option>
                        <option value="50">100</option>
                        <option value="50">150</option>
                        <option value="50">200</option>
                        <option value="50">300</option>
                        <option value="50">500</option>
                    </select>
                </td>
                <td class="position-size-cell">-</td>
                <td class="quantity-cell">-</td>
                <td class="tg-long-cell">-</td>
                <td class="liq-long-cell">-</td>
                <td class="tg-short-cell">-</td>
                <td class="liq-short-cell">-</td>
            </tr>

            <!-- Row 7 -->
            <tr class="calculator-row" data-row="7" data-symbol="DOGEUSDT">
                <td class="coin-name">DOGEUSDT</td>
                <td class="price-cell">-</td>
                <td>
                    <select class="leverage-select">
                        <option value="10">10</option>
                        <option value="15">15</option>
                        <option value="20">20</option>
                        <option value="25">25</option>
                        <option value="30">30</option>
                        <option value="35">35</option>
                        <option value="40">40</option>
                        <option value="45">45</option>
                        <option value="50">50</option>
                    </select>
                </td>
                <td>
                    <select class="account-size-select">
                        <option value="100">100</option>
                        <option value="125">125</option>
                        <option value="150">150</option>
                        <option value="175">175</option>
                        <option value="200">200</option>
                        <option value="225">225</option>
                        <option value="250">250</option>
                        <option value="275">275</option>
                        <option value="300">300</option>
                        <option value="325">325</option>
                        <option value="350">350</option>
                        <option value="375">375</option>
                        <option value="400">400</option>
                        <option value="425">425</option>
                        <option value="450">450</option>
                        <option value="475">475</option>
                        <option value="500">500</option>
                    </select>
                </td>
                <td>
                    <select class="target-profit-select">
                        <option value="10">10</option>
                        <option value="15">15</option>
                        <option value="20">20</option>
                        <option value="25">25</option>
                        <option value="30">30</option>
                        <option value="35">35</option>
                        <option value="40">40</option>
                        <option value="45">45</option>
                        <option value="50">50</option>
                        <option value="50">60</option>
                        <option value="50">70</option>
                        <option value="50">80</option>
                        <option value="50">90</option>
                        <option value="50">100</option>
                        <option value="50">150</option>
                        <option value="50">200</option>
                        <option value="50">300</option>
                        <option value="50">500</option>
                    </select>
                </td>
                <td class="position-size-cell">-</td>
                <td class="quantity-cell">-</td>
                <td class="tg-long-cell">-</td>
                <td class="liq-long-cell">-</td>
                <td class="tg-short-cell">-</td>
                <td class="liq-short-cell">-</td>
            </tr>

            <!-- Row 8 -->
            <tr class="calculator-row" data-row="8" data-symbol="DOTUSDT">
                <td class="coin-name">DOTUSDT</td>
                <td class="price-cell">-</td>
                <td>
                    <select class="leverage-select">
                        <option value="10">10</option>
                        <option value="15">15</option>
                        <option value="20">20</option>
                        <option value="25">25</option>
                        <option value="30">30</option>
                        <option value="35">35</option>
                        <option value="40">40</option>
                        <option value="45">45</option>
                        <option value="50">50</option>
                    </select>
                </td>
                <td>
                    <select class="account-size-select">
                        <option value="100">100</option>
                        <option value="125">125</option>
                        <option value="150">150</option>
                        <option value="175">175</option>
                        <option value="200">200</option>
                        <option value="225">225</option>
                        <option value="250">250</option>
                        <option value="275">275</option>
                        <option value="300">300</option>
                        <option value="325">325</option>
                        <option value="350">350</option>
                        <option value="375">375</option>
                        <option value="400">400</option>
                        <option value="425">425</option>
                        <option value="450">450</option>
                        <option value="475">475</option>
                        <option value="500">500</option>
                    </select>
                </td>
                <td>
                    <select class="target-profit-select">
                        <option value="10">10</option>
                        <option value="15">15</option>
                        <option value="20">20</option>
                        <option value="25">25</option>
                        <option value="30">30</option>
                        <option value="35">35</option>
                        <option value="40">40</option>
                        <option value="45">45</option>
                        <option value="50">50</option>
                        <option value="50">60</option>
                        <option value="50">70</option>
                        <option value="50">80</option>
                        <option value="50">90</option>
                        <option value="50">100</option>
                        <option value="50">150</option>
                        <option value="50">200</option>
                        <option value="50">300</option>
                        <option value="50">500</option>
                    </select>
                </td>
                <td class="position-size-cell">-</td>
                <td class="quantity-cell">-</td>
                <td class="tg-long-cell">-</td>
                <td class="liq-long-cell">-</td>
                <td class="tg-short-cell">-</td>
                <td class="liq-short-cell">-</td>
            </tr>

            <!-- Row 9 -->
            <tr class="calculator-row" data-row="9" data-symbol="MATICUSDT">
                <td class="coin-name">MATICUSDT</td>
                <td class="price-cell">-</td>
                <td>
                    <select class="leverage-select">
                        <option value="10">10</option>
                        <option value="15">15</option>
                        <option value="20">20</option>
                        <option value="25">25</option>
                        <option value="30">30</option>
                        <option value="35">35</option>
                        <option value="40">40</option>
                        <option value="45">45</option>
                        <option value="50">50</option>
                    </select>
                </td>
                <td>
                    <select class="account-size-select">
                        <option value="100">100</option>
                        <option value="125">125</option>
                        <option value="150">150</option>
                        <option value="175">175</option>
                        <option value="200">200</option>
                        <option value="225">225</option>
                        <option value="250">250</option>
                        <option value="275">275</option>
                        <option value="300">300</option>
                        <option value="325">325</option>
                        <option value="350">350</option>
                        <option value="375">375</option>
                        <option value="400">400</option>
                        <option value="425">425</option>
                        <option value="450">450</option>
                        <option value="475">475</option>
                        <option value="500">500</option>
                    </select>
                </td>
                <td>
                    <select class="target-profit-select">
                        <option value="10">10</option>
                        <option value="15">15</option>
                        <option value="20">20</option>
                        <option value="25">25</option>
                        <option value="30">30</option>
                        <option value="35">35</option>
                        <option value="40">40</option>
                        <option value="45">45</option>
                        <option value="50">50</option>
                        <option value="50">60</option>
                        <option value="50">70</option>
                        <option value="50">80</option>
                        <option value="50">90</option>
                        <option value="50">100</option>
                        <option value="50">150</option>
                        <option value="50">200</option>
                        <option value="50">300</option>
                        <option value="50">500</option>
                    </select>
                </td>
                <td class="position-size-cell">-</td>
                <td class="quantity-cell">-</td>
                <td class="tg-long-cell">-</td>
                <td class="liq-long-cell">-</td>
                <td class="tg-short-cell">-</td>
                <td class="liq-short-cell">-</td>
            </tr>

            <!-- Row 10 -->
            <tr class="calculator-row" data-row="10" data-symbol="LTCUSDT">
                <td class="coin-name">LTCUSDT</td>
                <td class="price-cell">-</td>
                <td>
                    <select class="leverage-select">
                        <option value="10">10</option>
                        <option value="15">15</option>
                        <option value="20">20</option>
                        <option value="25">25</option>
                        <option value="30">30</option>
                        <option value="35">35</option>
                        <option value="40">40</option>
                        <option value="45">45</option>
                        <option value="50">50</option>
                    </select>
                </td>
                <td>
                    <select class="account-size-select">
                        <option value="100">100</option>
                        <option value="125">125</option>
                        <option value="150">150</option>
                        <option value="175">175</option>
                        <option value="200">200</option>
                        <option value="225">225</option>
                        <option value="250">250</option>
                        <option value="275">275</option>
                        <option value="300">300</option>
                        <option value="325">325</option>
                        <option value="350">350</option>
                        <option value="375">375</option>
                        <option value="400">400</option>
                        <option value="425">425</option>
                        <option value="450">450</option>
                        <option value="475">475</option>
                        <option value="500">500</option>
                    </select>
                </td>
                <td>
                    <select class="target-profit-select">
                        <option value="10">10</option>
                        <option value="15">15</option>
                        <option value="20">20</option>
                        <option value="25">25</option>
                        <option value="30">30</option>
                        <option value="35">35</option>
                        <option value="40">40</option>
                        <option value="45">45</option>
                        <option value="50">50</option>
                        <option value="50">60</option>
                        <option value="50">70</option>
                        <option value="50">80</option>
                        <option value="50">90</option>
                        <option value="50">100</option>
                        <option value="50">150</option>
                        <option value="50">200</option>
                        <option value="50">300</option>
                        <option value="50">500</option>
                    </select>
                </td>
                <td class="position-size-cell">-</td>
                <td class="quantity-cell">-</td>
                <td class="tg-long-cell">-</td>
                <td class="liq-long-cell">-</td>
                <td class="tg-short-cell">-</td>
                <td class="liq-short-cell">-</td>
            </tr>
        </tbody>
    </table>

    <script>
        (function () {
            const SERVER = 'http://localhost:3000';
            document.querySelectorAll('.calculator-row').forEach(row => initializeRow(row));

            function initializeRow(row) {
                const rowNum = row.dataset.row;
                const symbol = row.dataset.symbol;
                const cells = {
                    price: row.querySelector('.price-cell'),
                    leverage: row.querySelector('.leverage-select'),
                    accountSize: row.querySelector('.account-size-select'),
                    targetProfit: row.querySelector('.target-profit-select'),
                    positionSize: row.querySelector('.position-size-cell'),
                    quantity: row.querySelector('.quantity-cell'),
                    tgLong: row.querySelector('.tg-long-cell'),
                    liqLong: row.querySelector('.liq-long-cell'),
                    tgShort: row.querySelector('.tg-short-cell'),
                    liqShort: row.querySelector('.liq-short-cell')
                };

                let currentPrice = NaN;
                let currentPositionSize = NaN;

                async function updatePrice() {
                    cells.price.textContent = 'Loading.';
                    try {
                        const res = await fetch(`${SERVER}/futures/${encodeURIComponent(symbol)}`);
                        const data = await res.json();
                        if (!res.ok || data.error) throw new Error(data.error || 'API error');
                        currentPrice = parseFloat(data.price) || NaN;
                        cells.price.textContent = Number.isFinite(currentPrice) ?
                            currentPrice.toLocaleString(undefined, { maximumFractionDigits: 5 }) : 'N/A';
                    } catch (err) {
                        console.error(`Row ${rowNum} fetch error:`, err);
                        currentPrice = NaN;
                        cells.price.textContent = 'Error';
                    }
                    recalcAll();
                }

                function calculatePositionSize() {
                    const acc = parseFloat(cells.accountSize.value) || 0;
                    const lev = parseFloat(cells.leverage.value) || 0;
                    const pos = acc * lev;
                    currentPositionSize = Number.isFinite(pos) ? pos : NaN;
                    cells.positionSize.textContent = Number.isFinite(pos) ? pos.toLocaleString(undefined, { maximumFractionDigits: 2 }) : '-';
                }

                function calculateQuantity() {
                    if (Number.isFinite(currentPositionSize) && Number.isFinite(currentPrice) && currentPrice > 0) {
                        const qty = currentPositionSize / currentPrice;
                        cells.quantity.textContent = qty.toLocaleString(undefined, { maximumFractionDigits: 5 });
                    } else {
                        cells.quantity.textContent = '-';
                    }
                }

                function calculateTargetsAndLiquidation() {
                    const entry = currentPrice;
                    const targetUSDT = parseFloat(cells.targetProfit.value) || 0;
                    const quantity = parseFloat(cells.quantity.textContent.replace(/,/g, '')) || 0;
                    const lev = parseFloat(cells.leverage.value) || 0;

                    if (Number.isFinite(entry) && entry > 0 && quantity > 0 && targetUSDT > 0) {
                        const priceChangeForTarget = targetUSDT / quantity;
                        const tgLong = entry + priceChangeForTarget;
                        const tgShort = entry - priceChangeForTarget;
                        cells.tgLong.textContent = tgLong.toLocaleString(undefined, { maximumFractionDigits: 5 });
                        cells.tgShort.textContent = tgShort.toLocaleString(undefined, { maximumFractionDigits: 5 });
                    } else {
                        cells.tgLong.textContent = '-';
                        cells.tgShort.textContent = '-';
                    }

                    if (Number.isFinite(entry) && entry > 0 && lev > 1) {
                        const liqLong = entry * (1 - 1 / lev);
                        const liqShort = entry * (1 + 1 / lev);
                        cells.liqLong.textContent = liqLong.toLocaleString(undefined, { maximumFractionDigits: 8 });
                        cells.liqShort.textContent = liqShort.toLocaleString(undefined, { maximumFractionDigits: 8 });
                    } else {
                        cells.liqLong.textContent = '-';
                        cells.liqShort.textContent = '-';
                    }
                }

                function recalcAll() {
                    calculatePositionSize();
                    calculateQuantity();
                    calculateTargetsAndLiquidation();
                }

                // events
                cells.leverage.addEventListener('change', recalcAll);
                cells.accountSize.addEventListener('change', recalcAll);
                cells.targetProfit.addEventListener('change', recalcAll);

                // initial fetch + periodic update
                updatePrice();
                setInterval(updatePrice, 10000);
            }
        })();
    </script>
</body>

</html>